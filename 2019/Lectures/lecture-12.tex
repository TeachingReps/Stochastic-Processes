% !TEX spellcheck = en_US
% !TEX spellcheck = LaTeX
%\documentclass[a4paper,10pt,english]{article}
\documentclass[all-lectures.tex]{subfiles}
%\input{header}
%\title{Lecture 01: Poisson Processes}
%\author{}
\setcounter{chapter}{3}

\begin{document}
%\maketitle

%\chapter{Discrete Time Markov Chains}
\setcounter{section}{4}
\setcounter{subsection}{0}

\section*{\centering{Lecture 12 \linebreak }}
\subsection{Example: M/GI/1 queue}
Consider an $M/GI/1$ queue. Let $\lambda$  be the Poisson arrival rate, $S_k$ the service time of the $k^{th}$ customer and $\E[S]$ be the mean service time. Let 
\begin{itemize}
\item $q_k = $ queue length just after the $k^{th}$ departure. 
\item $\hat{q}_k = $ queue length just before the $k^{th}$ arrival. 
\item $q_t =$ queue length at arbitrary time $t$.
\item $W_k = $ waiting time of the $k^{th}$ customer.
\end{itemize}
The process $\{q_k\}$ satisfies $q_{k+1} = (q_k -1)^+ + A_{k+1}$ where $A_k$ is the number of arrivals during the service of $(k+1)^{th}$ customer. Since $\{A_k\}$ is i.i.d., $\{q_k\}$ is a Markov chain. The state space $S = \{0,1,2\dots\}$ and it is easy that it is aperiodic and irreducible. By choosing $f(i) = i$, we can deduce using the test for positive recurrence that $\{q_k\}$ is positive recurrent when $\E[A_1] = \lambda \E[S] < 1$. Thus, we conclude that when $\lambda \E[S] < 1$, the process $\{q_k\}$ has a stationary distribution. We will  see later that when $\lambda\E[S] = 1$, $\{q_k\}$ is recurrent and when $\lambda \E[S] > 1$, it is transient. \\
\indent  The process $\{\hat{q}_k\}$ however, is not a Markov chain if $S_k$ is not exponentially distributed. But $\{\hat{q}_k\}$ is a regenerative process with regeneration epochs occurring when $k^{th}$ arrival sees an empty queue. That is, regenerative epochs for $\{\hat{q}_k\}$ occurs when $ \hat{q}_k = 0$. Let $\hat{\tau}$ be the regeneration length of $\{\hat{q}_k\}$. \\
\indent To obtain the conditions for existence for stationary distribution for $\{\hat{q}_k\}$, we can relate it to the process $\{q_k\}$. The process $\{q_k\}$ is also a regenerative process with regeneration epochs occurring when a departure leaves behind an empty queue. That is, the regeneration epochs correspond to $q_k = 0$. Let $\tau$ be the regeneration time of $\{q_k\}$. Now, we can see that $\tau = \hat{\tau}$. Since, $\{q_k\}$ has stationary distribution when $\lambda \E[S] < 1$, $\E[\tau] < \infty$. So, $\E[\hat{\tau}] < \infty$. Therefore, the process $\{\hat{q}_k\}$ is stationary iff $\{q_k\}$ is stationary. \\
\indent The process $\{W_k\}$ also has the same regeneration epochs as $\{q_k\}$ and hence has unique stationary distribution when $\lambda\E[S] < 1$.\\
\indent The process $\{q_t\}$ is also a regenerative process with regeneration epochs occurring arrivals see an empty queue. Let $T$ be the regeneration length of $\{q_t\}$. Then, considering one regenerative cycle, we can write $T = \sum_{k = 1}^{\hat{\tau}} a_k$ where $a_k$ is the inter-arrival time between $(k-1)^{th}$ and $k^{th}$ arrival. Now, $\hat{\tau}$, which is equal to the number of services in one regeneration cycle is a stopping time for the $\{a_k,S_k\}$ where $S_k$ is the service time of the $k^{th}$ arrival. Thus, we can use Wald's lemma to conclude that $\E[T] = \E[\hat{\tau}] \E[a_1]$. Thus, $\{q_t\}$ also has stationary distribution whenever $\lambda\E[S] < 1$.
\subsection{Rate of convergence to the stationary distribution}
{\color{red} Please ignore this section. i will update it soon. }
\begin{itemize}
\item If $\E[\tau^\alpha] < \infty$, then $|| X_k - \pi ||_{TV} < c_1 k^{-\alpha +1}$
\item If $\E[\beta^{\tau}] < \infty$, then $|| X_k - \pi||_{TV} \rightarrow 0 $ exponentially.
\end{itemize}
Here, $||\mu - \pi||_{TV}$ is the total variation distance between distributions $\mu$ and $\pi$. For finite state space $S$, $||\mu - \pi|| = 1/2 \sum_{x\in S} \mu(x) - \pi(x)$. \\
Let 
\begin{align*}
K_n^{x} = \frac{P^n(x,y)}{\pi(y)}.
\end{align*}
$K_n^{x} \rightarrow 1$ as $n \rightarrow \infty \ \forall x,y \in S$. Then, $L^p$ distance distance $||K_n-1||^p_{P,\pi}$is defined as 
\begin{align*}
||K_n-1||^p_{P,\pi} = \sum_{y\in S} |K_n(y)-1|^p \pi(y) \text{ for } 1 \leq p < \infty.
\end{align*}
\textbf{Mixing times:}
\begin{align*}
\tau(\epsilon) &= \min\{n: \sup_x ||P^n(x,.)-\pi||_{TV} \leq \epsilon\} \\
\tau_2(\epsilon) &= \min\{n: sup_x |K_n^x - 1|_{x,\pi} \leq \epsilon\}
\end{align*}
\end{document}


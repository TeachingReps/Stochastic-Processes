% !TEX spellcheck = en_US
% !TEX spellcheck = LaTeX
%\documentclass[a4paper,10pt,english]{article}
\documentclass[all-lectures.tex]{subfiles}
%\input{header}
%\title{Lecture 01: Poisson Processes}
%\author{}
\setcounter{chapter}{5}
\usepackage{enumitem}

\begin{document}
%\maketitle

%\chapter{Renewal Theory}
\setcounter{section}{2}
\setcounter{subsection}{1}
\chapter{Random Walks}
\section*{\centering{Lecture 22 \linebreak }}
\subsection{Definitions}
\begin{defn}[Random Walks]
Let $X_1,X_2,\dots$ be i.i.d., $S_0 = 0$ and $S_n = \sum_{k=1}^n X_k$. Then, $S_n$ is called \textit{random walk}. 
\end{defn}

If $\mu = \E[X_1]$ ($-\infty \leq \E[X_1] \leq \infty$) is defined, then by strong law of large numbers (SLLN) $S_n/n \to \E[X_1]$ a.s. as $n \to \infty$. According to law of iterated logarithms (LIL), if $Var(X_1) = \sigma^2 < \infty$,
\begin{align*}
\limsup_{n \to \infty} \frac{S_n-n\mu}{\sigma \sqrt{n\log \log n}} = +1 \text{ a.s. } \\
\liminf_{n \to \infty} \frac{S_n-n\mu}{\sigma \sqrt{n\log \log n}} = -1 \text{ a.s. } \\
\end{align*}
We can use martingales theory to analyze $S_n$. $S_n$ is also a Markov chain. So we can use Markov chain theory (although it may not have countable state space). If $X_k \geq 0$, we can use renewal theory. In this chapter, we use random walk theory and will also show how to use renewal theory when $X_1$ takes positive as well as negative values.\\
\indent There are three possibilities
\begin{enumerate}[label=(\arabic*)]
\item  $S_n \to -\infty$ a.s. as $n \to \infty$.
\item  $S_n \to \infty$ a.s. $n \to \infty$. 
\item  $\limsup_{n\to \infty} S_n = \infty$ a.s. and $\liminf_{n\to \infty} S_n = -\infty$ a.s.
\end{enumerate}
If $\E[X_1]$ exists ($-\infty \leq \E[X_1] \leq \infty$), then by SLLN, $(1)$ holds if $\mu <0$ and $(2)$ holds if $\mu>0$. By LIL, $(3)$ holds if $\sigma^2 < \infty$ and $\mu = 0$.

\begin{defn}
If for all finite intervals $I \subset \R$, $\sum_{n=0}^\infty \P\{S_n \in I\} = \sum_{n=1}^\infty \E[1\{S_n \in I\}] < \infty$, then the random walk $S_n$ is called \textit{transient}. Otherwise, it is called $recurrent$. 
\end{defn}
When $\mu < 0$ or $\mu > 0$, the random walk is transient. When $\mu =0$, the random walk is recurrent. \\
\begin{defn}[Ladder epochs and heights]
Let $T_1 = \inf\{n:S_n > 0\}$ and $T_k = \inf\{n>T_{k-1}, S_n>{S_{T_{k-1}}}\}$. The process $\{T_k\}$ is called \textit{strictly ascending ladder epochs} and $\{S_{T_k}\}$ is called \textit{strictly ascending ladder heights}. \\
\indent Let ${T}_{1}^- = \inf\{n:S_n \leq 0\}$ and ${T}_{k}^- = \inf\{n>{T}_{k-1}^-, S_n \leq {S_{{T}_{k-1}^-}}\}$. The process $\{{T}_{k}^-\}$ is called \textit{weakly descending ladder epochs} and $\{S_{{T}_{k}^-}\}$ is called \textit{weakly descending ladder heights}. \\
\indent When $S_n \to \infty$ a.s., then after some time $S_n$ will not go below $0$ and hence $\P[T_- < \infty] < 1$. Also, when $S_n \to -\infty$ a.s. then $\P\{T<\infty\} < 1$.
\end{defn}

Ladder heights and ladder epochs form renewal processes. Let $M_n = \sup_{1\leq k \leq n} S_k$ and $m_n = \inf_{1\leq k \leq n} S_k$. Since, $M_n \geq S_n$ and is monotonically increasing, 
\begin{enumerate}
\item If $S_n \to \infty$  a.s., then $M_n \uparrow \infty$ a.s. but $m_n \downarrow m > -\infty$ a.s.
\item If $S_n \to -\infty$ a.s., then $M_n \uparrow M < \infty$ a.s. and $m_n \to -\infty$ a.s.
\item If $S_n$ oscillates, then $M_n \uparrow \infty$ a.s. and $m_n \downarrow -\infty$ a.s.
\end{enumerate}

\begin{prop}
For GI/GI/1 queue, $W_n \sim M_n$.
\begin{proof}
Let $X_k = S_k - A_k$.
\begin{align*}
W_{k+1} &= (W_k + X_k)^+ \\
&= \max(0,W_k + X_k)) \\
&= \max(0,\max(0,W_{k-1}+X_{k-1}) + X_k)) \\
& \dots \\
&= \max(0,X_k,X_k+X_{k-1},X_k+X_{n-1}+X_{k-2},\dots,X_1) \\
&\sim \max(0,X_1,X_1+X_{2},X_1+X_{2}+X_{3},\dots,S_k) \\
&= \max(0,S_1,S_2,S_3,\dots,S_k) \\
&= M_k.
\end{align*}
\end{proof}
\end{prop}
We should note that $M_n \neq W_n$ a.s. and  $M_n$ is montonically increasing, but $W_n$ is not. Moreover, $(W_{n+1},W_n) \stackrel{d}{\neq} (M_{n+1},M_{n})$ even though $W_{n+1} \sim M_{n+1}$.
Now, 
\begin{align*}
(S_0,S_1,\dots,S_n) &\sim (0,X_1,X_1+X_2,\dots,X_1+X_2+\dots+X_n) \\
&\sim (0,X_n,X_n+X_{n-1},\dots,X_n+X_{n-1}+\dots +X_1)\\
&= (0,S_n-S_{n-1},S_{n-2}\dots, S_n - S_0)
\end{align*}
$\max\{0,S_n-S_{n-1},S_{n-2}\dots, S_n - S_0\} \stackrel{d}{=} S_n - m_n$. This shows that $(M_n,M_n - S_n) \sim (S_n - m_n, -m_n)$. \\
\indent We can also write $M_n = S_{N(n)}$ where $N(n)$ is number of ascending ladder epochs till time $n$. Let $Z_k = S_{T_k} -S_{T_{k-1}}$. If $\mu > 0$, then we will show that $\E[T_1] < \infty$.
\begin{prop}
If $\mu >0$,then 
\begin{align*}
\frac{M_n}{n} \to \E[X_1] \text{ a.s. as } n \to \infty.
\end{align*}
\begin{proof} From renewal theory $N(n)/n \to 1/\E[T_1]$ a.s. Thus, 
\begin{align*}
\lim_{n \to \infty} \frac{M_n}{n} &= \lim_{n \to \infty} \frac{\sum_{k=1}^{N(n)} Z_k}{n}\\
&= \lim_{n \to \infty} \frac{\sum_{k=1}^{N(n)} Z_k}{N(n)} \frac{N(n)}{n} \\
&= \frac{\E[Z_1]}{\E[T_1]} \text{ a.s.}\\
&= \frac{\E[\sum_{k=1}^{T_1} X_k]}{\E[T_1]}\text{ a.s.}\\
&= \E[X_1] \text{ a.s.} \qedhere
\end{align*}

\end{proof}
\end{prop}
Similarly, if $\mu <0$, $m_n/n \to \E[X_1]$ a.s.\\

\textbf{GI/GI/1 queue:} Take $X_k = s_k - A_k$. If $\mu = \E[X_1] = \E[s_1 - A_1] >0$, $M_n \uparrow \infty$ a.s. Therefore, since $W_n \sim M_n$, $\lim_{n \to \infty} \P\{ W_n \leq x\} =0$ for all $x$. Also, $W_n/n \to \E[X_1]$ a.s. \\
\indent When $\mu<0$, $M_n \to M$ a.s. where $M$ is a proper r.v. and $\P\{W_n \leq x\} \to \P\{M \leq x\}$. Then, the queue is stable. Also, $N(n) \to N$ a.s. where $N$ is a finite r.v. and 
\begin{align*}
M \stackrel{d}{=} \sum_{k=1}^N z_k,
\end{align*}
and $\P\{N=n\} = p^n(1-p)$ where $p = \P\{T_1 <\infty\}<1$. Also, conditioned on $N\geq k$, $z_1, z_2, \dots,z_k$ are i.i.d. and do not depend on $k$.
\end{document}


% !TEX spellcheck = en_US
% !TEX spellcheck = LaTeX
\documentclass[all-lectures.tex]{subfiles}
%\input{header}
\author{}

\begin{document}
%\maketitle
\setcounter{chapter}{2}
\setcounter{section}{1}
\section*{\centering{Lecture 5 \linebreak }}

\section{Limit Theorems}
We have 
\eq{
\lim_{t\to\infty} \P\{ N_t \ge n\} = \lim_{t\to\infty} \P\{S_n \le t\} =1.
}
Hence, $\lim_{t\to\infty} N(t) = \infty$ $a.s$. \\
\indent Let us denote by $S_{N(t)}$, the time of the last renewal \textit{prior to or at} time $t$ and by $S_{N(t)+1}$ the time of the first renewal \textit{after} time $t$.
\begin{prop}
With probability 1,
\eq{
\lim_{t\to\infty} \frac{N(t)}{t} \to \frac{1}{\mu}.
}
\end{prop}
\begin{proof}
Since, $S_{N(t)} < t < S_{N(t)+1}$, we see that
\eq{
\frac{S_{N(t)}}{N(t)} \leq \frac{t}{N(t)} < \frac{S_{N(t)+1}}{N(t)}. 
}
By strong law of large numbers $\frac{S_{N(t)}}{N(t)} \to \mu$ a.s. as $t \to \infty$ . Also,
\eq{
\frac{S_{N(t)+1}}{N(t)} = \left[\frac{S_{N(t)+1}}{N(t)+1}\right] \left[\frac{N(t)+1}{N(t)}\right] \to \mu \text{ a.s.} 
} \qedhere
\end{proof}

%\subsection{Elementary Renewal Theorem}
\begin{defn}
(Stopping Time)
$N$ a nonnegative integer valued random variable is a stopping time w.r.t. sequence $\{X_k\}$ if $\{ N\le n\}$ is a function of $\{X_{1}, X_{2}, \dots, X_n\}$.
\end{defn}
\begin{thm}
(Wald's Lemma)
If $N$ is a stopping time w.r.t. $\{X_k\}$, $\{X_k\}$ is i.i.d. and $\E[X_1] = \mu < \infty$, $E[N] < \infty$ then
\eq{
\E[\sum_{k=1}^{N} X_k] = \E[N] \E[X_1].
}
\end{thm}

\begin{proof}
Let 
\eq{
I_k = \begin{cases}
1,  & N \ge k\\
0,  & N < k
\end{cases}
}

Then we can write the following
\eq{
\sum_{k=1}^{N} X_k = \sum_{k=1}^{\infty} X_k I_k.
}

Hence,
\eq{
\E[\sum_{k=1}^{N} X_k] = \E[\sum_{k=1}^{\infty} X_k I_k] = \sum_{k=1}^{\infty} \E[X_k I_k].
}
Since $I_k$ is determined by $X_1, X_2, \dots, X_{k-1}$, therefore $I_k$ is independent of $X_k$. Thus we obtain
\eq{
\E[\sum_{k=1}^{N} X_k] &= \sum_{k=1}^{\infty} \E[X_k] \E[I_k] \\
&= \E[X_1] \sum_{k=1}^{\infty} \E[I_k]\\
&= \E[X_1] \sum_{k=1}^{\infty} \P\{ N \ge k\}\\
&= \E[X_1] \E[N].
}
\end{proof}

\begin{thm}[Elementary Renewal Theorem]
\eq{
\lim_{t \to \infty} \frac{\E[N(t)]}{t} = \frac{1}{\mu}.
}
\end{thm}
\begin{proof}
Let us denote $\E[N(t)]$ as $m(t)$ and we prove the result for $\mu < \infty$. We know that $S_{N(t)+1} > t$ and $N(t)+1$ is a stopping time. Taking expectations, by Wald's lemma, we get,
\eq{
\mu(m(t)+1) > t.
}
This implies 
\eq{
\liminf_{t \to \infty} \frac{m(t)}{t} \ge \frac{1}{\mu}.
}

To get the other way, define a new renewal process from $\{ X'_k, k=1,2,\dots \}$ where  $X'_k= \min(M,X_k)$, for a constant $M>0$.
Let $S'_n=\sum_1^n X'_k$ and $N'(t) = sup\{n,S'_n \le t\}$. The interarrival times for this truncated renewal process are bounded by $M$. Therefore
\eq{
S'_{N(t)+1} \le t+M.
}
Taking expectations on both sides we get,
\eq{
\mu_M(m'(t)+1) \le t+M
}
where $\mu_M = \E[X'_k]$. Thus
\eq{
\limsup_{t \to \infty} \frac{m'(t)}{t} \le \frac{1}{\mu_M}.
}
Since $m(t) \leq m'(t)$,
\eq{
\limsup_{t \to \infty} \frac{m(t)}{t} \le \frac{1}{\mu_M}. 
}
for all $M>0$. Taking $M \to \infty$, $\mu_M \to \mu$ then implies that $\limsup_{t \to \infty} m(t)/t \leq \mu$.
\end{proof}



\end{document}